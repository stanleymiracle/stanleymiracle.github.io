<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
  <head>
    <title>Scheme Emacs</title>
    <meta name="generator" content="emacs-wiki.el">
    <meta http-equiv="Content-Type"
	  content="text/html; charset=gb2312">
    <link rev="made" href="mailto:webmaster@wangyin.com">
    <link rel="home" href="WelcomePage.html">
    <link rel="index" href="WikiIndex.html">
    <LINK rel="stylesheet" href="../main.css" media="screen">
  </head>
  <body>
    <h1>Scheme Emacs</h1>
    <!-- Page published by Emacs Wiki begins here -->






<h2>cmuscheme.el 的一个 hack</h2>

<p>
我给 cmuscheme.el 加入了执行命令时，自动起动 scheme 解释器，
自动显示 <em>scheme</em> buffer 在另一个窗口的功能。加入了
scheme-send-line 函数，并且绑定到 C-c C-c。只需要把下面这些
加入 .emacs:

</p>

<pre class="example">(defun wy-scheme-mode-hook ()
  (defun scheme-send-region (start end)
    &quot;Send the current region to the inferior Scheme process.&quot;
    (interactive &quot;r&quot;)
    (let ((origbuffer (current-buffer))
          (proc (get-buffer-process (if (eq major-mode 'inferior-scheme-mode)
                                        (current-buffer)
				      scheme-buffer))))
      (or proc 
          (progn
            (run-scheme scheme-program-name)
            (pop-to-buffer (process-buffer (scheme-proc)) t)
            (goto-char (point-max))
            (pop-to-buffer origbuffer))))

    (comint-send-region (scheme-proc) start end)
    (comint-send-string (scheme-proc) &quot;\n&quot;)
    (scheme-display-buffer))
)

(add-hook 'scheme-mode-hook 'wy-scheme-mode-hook)

(defun scheme-display-buffer ()
  &quot;Display the inferior-maxima-process buffer so the recent output is visible.&quot;
  (interactive)
  (let ((origbuffer (current-buffer)))
    (pop-to-buffer (process-buffer (scheme-proc)) t)
    (goto-char (point-max))
    (pop-to-buffer origbuffer)))

(defun scheme-send-line ()
  &quot;Send the line to the inferior Scheme process.&quot;
  (interactive)
  (scheme-send-region 
   (save-excursion
     (beginning-of-line) (point))
   (save-excursion
     (progn (end-of-line) (point)))))

(define-key scheme-mode-map (kbd &quot;C-c C-c&quot;)
		     'scheme-send-line)

</pre>

<h3>还存在的问题</h3>

<p>
每次 C-c e 送出一行的时候，会向 scheme 进程输出两个换行符号。
不过这个问题暂时可以忍受 :P

</p>

<h2>Quack</h2>

<p>
<img src="../images/quack.png" alt="../images/quack.png">
</p><!-- Page published by Emacs Wiki ends here -->
    <div class="navfoot">
    <hr>
      <table width="100%" border="0" summary="Footer navigation">
	<tr>
	  <td width="33%" align="left">
	    <span class="footdate">最后更新：2003-05-29</span>
	  </td>
	  <td width="60%" align="center">
	    <span class="foothome">
	      <a href="../index.html">王垠的主页</a> / <a href="WelcomePage.html">WiKi首页</a>/<a href="WikiIndex.html">索引</a>/<a href="wiki_frame.html" target=_parent>框架页</a>/<a href="SchemeEmacs.html" target=_parent>取消框架</a>
	    </span>
	  </td>
	  <td width="33%" align="right">
	    
	  </td>
	</tr>
      </table>
    </div>


  </body>
</html>
