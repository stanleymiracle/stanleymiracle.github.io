<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
  <head>
    <title>Tex Problems</title>
    <meta name="generator" content="emacs-wiki.el">
    <meta http-equiv="Content-Type"
	  content="text/html; charset=utf-8">
    <link rev="made" href="mailto:webmaster@wangyin.com">
    <link rel="home" href="WelcomePage.html">
    <link rel="index" href="WikiIndex.html">
    <LINK rel="stylesheet" href="../main.css" media="screen">
  </head>
  <body>
    <h1>Tex Problems</h1>
    <!-- Page published by Emacs Wiki begins here -->






<h2>The TeXbook 练习题 7.10 的勘误。</h2>

<h3>Knuth 的 TeXbook 练习题 7.10</h3>

<p>
Define a control sequence \appendroman with three parameters
such that \appendroman#1#2#3 defines control sequence #1 to
expand to a control sequence whose name is the name of
control sequence #2 followed by the value of the positive
integer #3 expressed in roman numerals. For example, suppose
\count20 equals 30; then  \appendroman\a\TeX{\count20}
should have the same e ect as  \def\a{\<a class="nonexistent" href="/cdn-cgi/l/email-protection#d4a3b1b6b9b5a7a0b1a694a3b5bab3adbdbafab7bbb9">TeXxxx</a>} .

</p>

<h3>两次勘误</h3>

<p>
在第 2 版和第3 版有两次勘误：

</p>

<p>
第二版改为：

</p>

<pre class="example">\def\appendroman#1#2#3{\edef#1{\def\noexpand#1{\csname
</pre>

<p>
这个显然少印了一部分。

</p>

<p>
第三版改为

</p>

<pre class="example">\def\appendroman#1#2#3{\edef#1{\csname
      \expandafter\gobble\string#2\romannumeral#3\endcsname}}
</pre>

<p>
所以其实算是只改了一次。以后直到“Millennium Edition”也没有
修改过。

</p>

<h3>正确答案</h3>

<p>
其实这个第三版修改之后的答案仍然是错误的。我们可以用以下这个
例子来证明：

</p>

<pre class="example">\input manmac

\def\gobble#1{}

% two definitions

\def\appendromanwrong#1#2#3{\edef#1{\csname
      \expandafter\gobble\string#2\romannumeral#3\endcsname}}

\def\appendromancorrect#1#2#3{%
\expandafter\def\expandafter#1\expandafter{%
\csname\expandafter\gobble\string#2\romannumeral#3\endcsname}}

% test case

\count20=30
\def\TeXxxx{Orinial definition for TeXxxx}

\appendromanwrong\awrong\TeX{\count20}

$\meaning\awrong$

\awrong

\appendromancorrect\acorrect\TeX{\count20}
$\meaning\acorrect$

\acorrect


\bigskip
After a redefinition for |\TeXxxx|:

\def\TeXxxx{Modified definition for TeXxxx}

\awrong

\acorrect

\bye
</pre>

<p>
这个例子证明，第3版的答案定义的 \appendroman 实际上使得
当 \count20 存放的书是 30 时，

</p>

<pre class="example">\appendroman\a\TeX{\count20}
</pre>

<p>
跟 \edef\a{\<a class="nonexistent" href="/cdn-cgi/l/email-protection#ff889a9d929e8c8b9a8dbf889e9198869691d19c9092">TeXxxx</a>} 有同样的效果，而不是跟 \def\a{\<a class="nonexistent" href="/cdn-cgi/l/email-protection#106775727d71636475625067717e7769797e3e737f7d">TeXxxx</a>}
有同样的效果。

</p>

<p>
更正后的答案才是正确的。</p>
<!-- Page published by Emacs Wiki ends here -->
<div class="navfoot">
    <hr>
      <table width="100%" border="0" summary="Footer navigation">
	<tr>
	  <td width="33%" align="left">
	    <span class="footdate">最后更新：2003-06-05</span>
	  </td>
	  <td width="60%" align="center">
	    <span class="foothome">
	      <a href="../index.html">主页</a> / <a href="WelcomePage.html">WiKi首页</a>/<a href="WikiIndex.html">索引</a>/<a href="wiki_frame.html" target=_parent>框架页</a>/<a href="TexProblems.html" target=_parent>取消框架</a>
	    </span>
	  </td>
	  <td width="33%" align="right">
	    
	  </td>
	</tr>
      </table>
    </div>


  <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
</html>
