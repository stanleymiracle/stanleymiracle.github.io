<!doctype html public "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!--

Generated from intro.tex by tex2page, v 20050501
(running on MzScheme 205, unix), 
(c) Dorai Sitaram, 
http://www.ccs.neu.edu/~dorai/tex2page/tex2page-doc.html

-->
<head>
<title>
tex2page 使用指南
</title>
<link rel="stylesheet" type="text/css" href="intro-Z-S.css" title=default>
<link rel="stylesheet" type="text/css" href="tex2page.css" title=default>
<meta name=robots content="noindex,follow">
<meta http-equiv="Content-Type" content="text/html;charset=gb2312"></head>
<body>
<div id=content>
<div align=right class=navigation><i>[<span><a href="intro.html">首页</a>, <a href="intro-Z-H-14.html">上一页</a></span><span>, <a href="intro-Z-H-16.html">下一页</a></span><span>; &nbsp;&nbsp;</span><span><a href="intro-Z-H-1.html#node_toc_start">目录 </a></span><span><span>; &nbsp;&nbsp;</span><a href="intro-Z-H-21.html#node_index_start"> 索引 </a></span>]</i></div>
<p></p>
<a name="node_chap_14"></a>
<h1 class=chapter>
<div class=chapterheading><a href="intro-Z-H-1.html#node_toc_node_chap_14">第十四章</a></div><br>
<a href="intro-Z-H-1.html#node_toc_node_chap_14">排版 Scheme</a></h1>
<p><a name="node_idx_144"></a>
<a name="node_idx_146"></a>
<a name="node_idx_148"></a></p>
<p>
</p>
<a name="node_sec_14.1"></a>
<h2><a href="intro-Z-H-1.html#node_toc_node_sec_14.1">14.1&nbsp;&nbsp;<code class=verbatim>\scm</code></a></h2>
<p>用 <code class=verbatim>\scm</code> 把 Scheme 程序括起来就可以进行显示了，并且含
有语法加亮信息。你只要试用 css.t2p 里提供的 CSS 样式就可以得
到很漂亮的 Scheme 语法加亮。比如：</p>
<p>
</p>
<pre class=verbatim>\scm{&nbsp;
(define fact&nbsp;
  &quot;The factorial function&quot;&nbsp;
  (lambda (n)&nbsp;
    (if (= n 0) 1 ;the base case&nbsp;
        (* n (fact (- n 1))))))&nbsp;
}</pre><p></p>
<p>结果是：</p>
<p></p>
<pre class=scheme>(<span class=keyword>define</span> <span class=variable>fact</span>
  <span class=selfeval>&quot;The factorial function&quot;</span>
  (<span class=keyword>lambda</span> (<span class=variable>n</span>)
    (<span class=keyword>if</span> (<span class=variable>=</span> <span class=variable>n</span> <span class=selfeval>0</span>) <span class=selfeval>1</span> <span class=comment>;the base case</span>
        (<span class=variable>*</span> <span class=variable>n</span> (<span class=variable>fact</span> (<span class=variable>-</span> <span class=variable>n</span> <span class=selfeval>1</span>))))))
</pre><p></p>
<p>
</p>
<a name="node_sec_14.2"></a>
<h2><a href="intro-Z-H-1.html#node_toc_node_sec_14.2">14.2&nbsp;&nbsp;Scheme 的样式</a></h2>
<p>有了语法加亮的信息还不能把各种关键字用不同的颜色显示。
你必须在 CSS 文件里定义样式，或者把这些样式使用
<code class=verbatim>\cssblock ...\endcssblock</code> 的形式 嵌入 HTML 中。
比如：</p>
<p>
<a name="node_idx_150"></a></p>
<p>
</p>
<pre class=verbatim>\cssblock&nbsp;
.scheme             {color: brown} /* background punctuation */&nbsp;
.scheme  .keyword   {color: #990000; font-weight: bold}&nbsp;
.scheme  .builtin   {color: #990000}&nbsp;
.scheme  .variable  {color: navy}&nbsp;
.scheme  .global    {color: purple}&nbsp;
.scheme  .selfeval  {color: green}&nbsp;
.scheme  .comment   {color: teal}&nbsp;
\endcssblock&nbsp;
</pre><p></p>
<p>
就可以对 Scheme 语句的各种关键字，变量等进行语法加亮了。</p>
<p>
</p>
<a name="node_sec_14.3"></a>
<h2><a href="intro-Z-H-1.html#node_toc_node_sec_14.3">14.3&nbsp;&nbsp;定义关键字</a></h2>
<p>你可以使用</p>
<p>
<a name="node_idx_152"></a></p>
<p>
</p>
<pre class=verbatim>\scmbuiltin{cons car cdr}&nbsp;
</pre><p></p>
<p>
这样的形式定义内部函数。</p>
<p>
<a name="node_idx_154"></a>
</p>
<pre class=verbatim>\scmkeyword{define-class unwind-protect}&nbsp;
</pre><p></p>
<p>
这样的形式定义关键字。</p>
<p>
使用</p>
<p>
<a name="node_idx_156"></a></p>
<p>
</p>
<pre class=verbatim>\scmvariable{and 42 +i}&nbsp;
</pre><p></p>
<p>
的形式定义变量。这样它们就能被加上特殊的颜色了。</p>
<p>
</p>
<a name="node_sec_14.4"></a>
<h2><a href="intro-Z-H-1.html#node_toc_node_sec_14.4">14.4&nbsp;&nbsp;slatex</a></h2>
<p><a name="node_idx_158"></a></p>
<p>
以上都是 tex2page 自己提供的排版 Scheme的方式。
对 Scheme 排版，最好使用 Slatex, 它可以在</p>
<p>
<a href="http://www.ccs.neu.edu/home/dorai/slatex/slatxdoc.html">http://www.ccs.neu.edu/home/dorai/slatex/slatxdoc.html</a></p>
<p>
下载。</p>
<p>
在装好 slatex 之后。只要</p>
<p>
</p>
<pre class=verbatim>\usepackage{slatex}&nbsp;
</pre><p></p>
<p>
就可以使用 slatex 提供的各种功能了。</p>
<p>
</p>
<a name="node_sec_14.4.1"></a>
<h3><a href="intro-Z-H-1.html#node_toc_node_sec_14.4.1">14.4.1&nbsp;&nbsp;schemedisplay 环境</a></h3>
<p>使用 tex2page 提供的 <code class=verbatim>\scm{...}</code> 如果内容太长容易出错，所以用</p>
<p>
<a name="node_idx_160"></a></p>
<p>
</p>
<pre class=verbatim>\begin{schemedisplay}&nbsp;
...&nbsp;
\end{schemedisplay}&nbsp;
</pre><p></p>
<p>
就好多了。</p>
<p>
</p>
<a name="node_sec_14.4.2"></a>
<h3><a href="intro-Z-H-1.html#node_toc_node_sec_14.4.2">14.4.2&nbsp;&nbsp;插入段落的 Scheme 语句</a></h3>
<p>段落中的 Scheme 语句，比如 <code class=scheme>(<span class=variable>cons</span> <span class=keyword>'</span><span class=variable>a</span> <span class=keyword>'</span>(<span class=variable>b</span> <span class=variable>c</span>))</code>, 可以这样输入：</p>
<p>

<a name="node_idx_162"></a>
</p>
<pre class=verbatim>\scheme|(cons 'a '(b c))|&nbsp;
</pre><p></p>
<p>
</p>
<a name="node_sec_14.4.3"></a>
<h3><a href="intro-Z-H-1.html#node_toc_node_sec_14.4.3">14.4.3&nbsp;&nbsp;插入 Scheme 程序文件</a></h3>
<p>如果要读入一个 Scheme 程序文件就使用</p>
<p>
</p>
<pre class=verbatim>\schemeinput{evenodd.scm}&nbsp;
% the .scm is optional!&nbsp;
</pre><p></p>
<p>
上面介绍的这些这些基本够用了。如果你还不满足就继续看下一节。</p>
<p>
</p>
<a name="node_sec_14.4.4"></a>
<h3><a href="intro-Z-H-1.html#node_toc_node_sec_14.4.4">14.4.4&nbsp;&nbsp;<code class=verbatim>\schemeresult</code></a></h3>
<p>Scheme 解释器的输出结果可以用一种特殊的颜色显示：</p>
<p>
</p>
<pre class=verbatim>\scheme|((lambda () (cons 'lambda&nbsp;
'cons)))| yields&nbsp;
\schemeresult|(lambda . cons)|.&nbsp;
</pre><p></p>
<p>
结果是：</p>
<p>
<code class=scheme>((<span class=keyword>lambda</span> () (<span class=variable>cons</span> <span class=keyword>'</span><span class=keyword>lambda</span>
<span class=keyword>'</span><span class=variable>cons</span>)))</code> yields
<code class=schemeresponse>(<span class=keyword>lambda</span> . <span class=variable>cons</span>)</code>.</p>
<p>
</p>
<a name="node_sec_14.4.5"></a>
<h3><a href="intro-Z-H-1.html#node_toc_node_sec_14.4.5">14.4.5&nbsp;&nbsp;特殊符号</a></h3>
<p>你想不想把 <code class=scheme>(<span class=keyword>lambda</span> () (<span class=keyword>begin</span> ...)</code> 都用

<code class=scheme>(<img src="intro-Z-G-17.png" border="0" alt="\lambda"> () (<span class=keyword>begin</span> ...)</code> 来显示？</p>
<p>
用</p>
<p>
<a name="node_idx_164"></a>
<a name="node_idx_166"></a></p>
<p>
</p>
<pre class=verbatim>\setspecialsymbol{lambda}{$\lambda$}&nbsp;
</pre><p></p>
<p>
就可以达到你的目的。我们还可以花哨一点：</p>
<p>
</p>
<pre class=verbatim>\setspecialsymbol{lambda}{$\lambda$}&nbsp;
\setspecialsymbol{and}{$\land$}&nbsp;
\setspecialsymbol{equiv?}{$\equiv$}&nbsp;
\setspecialsymbol{below?}{$\subseteq$}&nbsp;
\setspecialsymbol{above?}{$\supseteq$}&nbsp;
\setspecialsymbol{a1}{$a_1$}&nbsp;
\setspecialsymbol{a2}{$a_2$}&nbsp;
&nbsp;
\begin{schemedisplay}&nbsp;
(define equiv?&nbsp;
  (lambda (a1 a2)&nbsp;
    (and (below? a1 a2)&nbsp;
         (above? a1 a2))))&nbsp;
\end{schemedisplay}&nbsp;
</pre><p></p>
<p>
显示为：






</p>
<p>
</p>
<div align=left><pre class=scheme>(<span class=keyword>define</span> <img src="intro-Z-G-18.png" border="0" alt="\equiv">
  (<img src="intro-Z-G-19.png" border="0" alt="\lambda"> (<img src="intro-Z-G-20.png" border="0" alt="a_1"> <img src="intro-Z-G-21.png" border="0" alt="a_2">)
    (<img src="intro-Z-G-22.png" border="0" alt="\land"> (<img src="intro-Z-G-23.png" border="0" alt="\subseteq"> <img src="intro-Z-G-24.png" border="0" alt="a_1"> <img src="intro-Z-G-25.png" border="0" alt="a_2">)
         (<img src="intro-Z-G-26.png" border="0" alt="\supseteq"> <img src="intro-Z-G-27.png" border="0" alt="a_1"> <img src="intro-Z-G-28.png" border="0" alt="a_2">))))
</pre></div><p></p>
<p>
</p>
<a name="node_sec_14.4.6"></a>
<h3><a href="intro-Z-H-1.html#node_toc_node_sec_14.4.6">14.4.6&nbsp;&nbsp;定义关键字</a></h3>
<p><a name="node_idx_168"></a>
<a name="node_idx_170"></a>
<a name="node_idx_172"></a>
<a name="node_idx_174"></a></p>
<p>
</p>
<pre class=verbatim>\setkeyword&nbsp;
\setconstant&nbsp;
\setvariable&nbsp;
\setdata&nbsp;
</pre><p></p>
<p>
可以定义你自己需要的关键字，常数，变量，数据，它们会被正确的
语法加亮。比如，通常 cons 不是一个关键字，它一般显示为：</p>
<p>
</p>
<pre class=scheme>(<span class=variable>cons</span> <span class=keyword>'</span><span class=variable>a</span> <span class=keyword>'</span>(<span class=variable>b</span> <span class=variable>c</span>))
</pre><p></p>
<p>
我们用了</p>
<p>
<a name="node_idx_176"></a></p>
<p>
</p>
<pre class=verbatim>\setkeyword{cons}&nbsp;
</pre><p></p>
<p>
之后，cons 就用跟 define 一样的方式显示了：</p>
<p>
</p>
<p>
</p>
<pre class=scheme>(<span class=keyword>cons</span> <span class=keyword>'</span><span class=variable>a</span> <span class=keyword>'</span>(<span class=variable>b</span> <span class=variable>c</span>))
</pre><p></p>
<p>
</p>
<a name="node_sec_14.4.7"></a>
<h3><a href="intro-Z-H-1.html#node_toc_node_sec_14.4.7">14.4.7&nbsp;&nbsp;<code class=verbatim>\scmdribble</code></a></h3>
<p><a name="node_idx_178"></a>
<a name="node_idx_180"></a></p>
<p>
这个命令可以把 <code class=verbatim>\scm</code> 区域里的内容送到最近的一个
<a href="intro-Z-H-13.html#node_tag_Temp_6"><code class=verbatim>\verbwritefile</code></a> 指定的文件里，同时把这些代码语法加亮在
文档中显示。</p>
<p>
这可以被作为一种 Scheme “文学编程”的方式。我来试试：</p>
<p>
</p>
<pre class=verbatim>\verbwritefile test1.scm&nbsp;
\scmdribble{&nbsp;
(define factorial&nbsp;
  (lambda (n)&nbsp;
    (if (= n 0)&nbsp;
        ;\scheme{(zero? n)}&nbsp;
        ;also possible&nbsp;
        1 (* n (factorial&nbsp;
                 (- n 1))))))&nbsp;
}&nbsp;
</pre><p></p>
<p>
嗯。还真是生成了一个文件叫做 test1.scm. 里面是这些代码。</p>
<p>
</p>
<pre class=scheme>(<span class=keyword>define</span> <span class=variable>factorial</span>
  (<img src="intro-Z-G-29.png" border="0" alt="\lambda"> (<span class=variable>n</span>)
    (<span class=keyword>if</span> (<span class=variable>=</span> <span class=variable>n</span> <span class=selfeval>0</span>)
        <span class=comment>;\scheme{(zero? n)}</span>
        <span class=comment>;also possible</span>
        <span class=selfeval>1</span> (<span class=variable>*</span> <span class=variable>n</span> (<span class=variable>factorial</span>
                 (<span class=variable>-</span> <span class=variable>n</span> <span class=selfeval>1</span>))))))
</pre><p></p>
<p>
</p>
<p>
</p>
<div align=right class=navigation><i>[<span><a href="intro.html">首页</a>, <a href="intro-Z-H-14.html">上一页</a></span><span>, <a href="intro-Z-H-16.html">下一页</a></span><span>; &nbsp;&nbsp;</span><span><a href="intro-Z-H-1.html#node_toc_start">目录 </a></span><span><span>; &nbsp;&nbsp;</span><a href="intro-Z-H-21.html#node_index_start"> 索引 </a></span>]</i></div>
<p></p>
</div>
</body>
</html>
